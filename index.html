<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„ Polymarket äº¤æ˜“è¿½è¸ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: white;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        .input-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        .input-section input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .input-section button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        .input-section button:hover {
            background: #45a049;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }
        .stat-card h3 {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 10px;
        }
        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            color: #4CAF50;
        }
        .trades-table {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            overflow: hidden;
        }
        .trades-table h2 {
            padding: 20px;
            background: rgba(0,0,0,0.2);
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        th {
            background: rgba(0,0,0,0.2);
            font-size: 12px;
            color: #aaa;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #aaa;
        }
        .buy { color: #4CAF50; }
        .sell { color: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æˆ‘çš„ Polymarket äº¤æ˜“è¿½è¸ª</h1>
        
        <div class="input-section">
            <input type="text" id="walletAddress" placeholder="è¾“å…¥ä½ çš„é’±åŒ…åœ°å€ (0x...)" />
            <button onclick="loadData()">æŸ¥è¯¢äº¤æ˜“æ•°æ®</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>ğŸ“… ä»Šæ—¥äº¤æ˜“</h3>
                <div class="value" id="dailyCount">-</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ“Š æœ¬å‘¨äº¤æ˜“</h3>
                <div class="value" id="weeklyCount">-</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ“ˆ æœ¬æœˆäº¤æ˜“</h3>
                <div class="value" id="monthlyCount">-</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ’° æ€»äº¤æ˜“æ¬¡æ•°</h3>
                <div class="value" id="totalCount">-</div>
            </div>
        </div>

        <div class="trades-table">
            <h2>ğŸ“‹ æœ€è¿‘äº¤æ˜“è®°å½•</h2>
            <table>
                <thead>
                    <tr>
                        <th>æ—¶é—´</th>
                        <th>å¸‚åœº</th>
                        <th>ç±»å‹</th>
                        <th>æ•°é‡</th>
                        <th>ä»·æ ¼</th>
                    </tr>
                </thead>
                <tbody id="tradesBody">
                    <tr>
                        <td colspan="5" class="loading">è¯·è¾“å…¥é’±åŒ…åœ°å€åç‚¹å‡»æŸ¥è¯¢</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // ä¿å­˜åœ°å€åˆ°æœ¬åœ°
        window.onload = function() {
            const saved = localStorage.getItem('polymarket_address');
            if (saved) {
                document.getElementById('walletAddress').value = saved;
            }
        }

        async function loadData() {
            const address = document.getElementById('walletAddress').value.trim();
            
            if (!address) {
                alert('è¯·è¾“å…¥é’±åŒ…åœ°å€ï¼');
                return;
            }
            
            // ä¿å­˜åœ°å€
            localStorage.setItem('polymarket_address', address);
            
            // æ˜¾ç¤ºåŠ è½½ä¸­
            document.getElementById('tradesBody').innerHTML = 
                '<tr><td colspan="5" class="loading">åŠ è½½ä¸­...</td></tr>';
            
            try {
                // è°ƒç”¨ Polymarket API
                const response = await fetch(
                    `https://data-api.polymarket.com/activity?user=${address}&limit=100`
                );
                const data = await response.json();
                
                // å¤„ç†æ•°æ®
                processData(data);
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('tradesBody').innerHTML = 
                    '<tr><td colspan="5" class="loading">åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥åœ°å€æ˜¯å¦æ­£ç¡®</td></tr>';
            }
        }

        function processData(trades) {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
            const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);
            
            let dailyCount = 0;
            let weeklyCount = 0;
            let monthlyCount = 0;
            
            trades.forEach(trade => {
                const tradeDate = new Date(trade.timestamp || trade.createdAt);
                if (tradeDate >= today) dailyCount++;
                if (tradeDate >= weekAgo) weeklyCount++;
                if (tradeDate >= monthAgo) monthlyCount++;
            });
            
            // æ›´æ–°ç»Ÿè®¡
            document.getElementById('dailyCount').textContent = dailyCount;
            document.getElementById('weeklyCount').textContent = weeklyCount;
            document.getElementById('monthlyCount').textContent = monthlyCount;
            document.getElementById('totalCount').textContent = trades.length;
            
            // æ›´æ–°è¡¨æ ¼
            const tbody = document.getElementById('tradesBody');
            
            if (trades.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="loading">æš‚æ— äº¤æ˜“è®°å½•</td></tr>';
                return;
            }
            
            tbody.innerHTML = trades.slice(0, 50).map(trade => {
                const date = new Date(trade.timestamp || trade.createdAt);
                const dateStr = date.toLocaleString('zh-CN');
                const side = trade.side || trade.type || 'N/A';
                const isBuy = side.toLowerCase().includes('buy');
                
                return `
                    <tr>
                        <td>${dateStr}</td>
                        <td>${(trade.market || trade.title || 'N/A').substring(0, 40)}...</td>
                        <td class="${isBuy ? 'buy' : 'sell'}">${side}</td>
                        <td>${trade.size || trade.amount || 'N/A'}</td>
                        <td>$${trade.price || 'N/A'}</td>
                    </tr>
                `;
            }).join('');
        }
    </script>
</body>
</html>
